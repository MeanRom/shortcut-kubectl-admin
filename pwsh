function kube {
    param(
        [Parameter(Mandatory=$true, Position=0)]
        [string]$Command,

        [Parameter(Position=1)]
        [string]$SubCommand
    )

    switch ($Command) {
        "admin" {
            switch ($SubCommand) {
                "start" {
                    kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard-kong-proxy 8443:443
                }
                "token" {
                    if ([string]::IsNullOrEmpty($SubCommand)) {
                        kubectl create token admin-user -n kubernetes-dashboard
                    } else {
                        kubectl create token $SubCommand -n kubernetes-dashboard
                    }
                }
                "install" {
                    helm repo add kubernetes-dashboard https://kubernetes.github.io/dashboard/
                    helm upgrade --install kubernetes-dashboard kubernetes-dashboard/kubernetes-dashboard --create-namespace --namespace kubernetes-dashboard
                }
                "user" {
                    if ([string]::IsNullOrEmpty($SubCommand)) {
                        kubectl create serviceaccount admin-user -n kubernetes-dashboard
                    } else {
                        kubectl create serviceaccount $SubCommand -n kubernetes-dashboard
                    }
                }
                "fix-forbidden" {
                    kubectl create clusterrolebinding admin-user-binding --clusterrole=cluster-admin --serviceaccount=kubernetes-dashboard:admin-user
                }
                default {
                    Write-Host "Usage: kube admin {start|token|install|user|fix-forbidden} | use the command 'kube help' for more information"
                }
            }
        }
        "switch" {
            kubectl config use-context "$SubCommand"
        }
        default { # Covers "help" and any other default/invalid command
            Write-Host @"
Usage: kube {admin|switch|help}
-------
admin start: Start the kubernetes-dashboard service
admin token: Get a token for admin-user
admin token <name>: Get a token for admin-user with a custom name
admin user: Create admin-user service account
admin user <name>: Create admin-user service account with a custom name
admin install: Install the kubernetes-dashboard
admin fix-forbidden: Fix forbidden errors
switch <context>: Switch kubectl context
-------
"@
        }
    }
}